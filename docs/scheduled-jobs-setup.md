# Render å®šæœŸä»»å‹™è¨­ç½®æŒ‡å—

## æ¦‚è¿°

æœ¬æŒ‡å—å°‡å¹«åŠ©ä½ è¨­ç½®å’Œé…ç½® Render çš„å®šæœŸä»»å‹™ï¼Œä»¥è‡ªå‹•åŸ·è¡Œå„ç¨®ç¶­è­·ã€æ¸…ç†å’Œæ›´æ–°æ“ä½œã€‚

## ğŸ¯ å®šæœŸä»»å‹™æ¸…å–®

### ç”¨æˆ¶ç®¡ç†ä»»å‹™

| ä»»å‹™åç¨±            | æè¿°             | åŸ·è¡Œé »ç‡ | åŸ·è¡Œæ™‚é–“  | å‘½ä»¤                                            |
| ------------------- | ---------------- | -------- | --------- | ----------------------------------------------- |
| `cleanup-reminders` | ç™¼é€å¸³è™Ÿåˆªé™¤æé†’ | æ¯å¤©     | å‡Œæ™¨ 2:00 | `node scripts/render-jobs.js cleanup-reminders` |
| `cleanup-users`     | åˆªé™¤æœªé©—è­‰ç”¨æˆ¶   | æ¯å¤©     | å‡Œæ™¨ 3:00 | `node scripts/render-jobs.js cleanup-users`     |

### é€šçŸ¥ç³»çµ±ä»»å‹™

| ä»»å‹™åç¨±                       | æè¿°             | åŸ·è¡Œé »ç‡ | åŸ·è¡Œæ™‚é–“   | å‘½ä»¤                                                       |
| ------------------------------ | ---------------- | -------- | ---------- | ---------------------------------------------------------- |
| `hot-content-notifications`    | ç™¼é€ç†±é–€å…§å®¹é€šçŸ¥ | æ¯å¤©     | ä¸Šåˆ 9:00  | `node scripts/render-jobs.js hot-content-notifications`    |
| `weekly-summary-notifications` | ç™¼é€é€±å ±æ‘˜è¦é€šçŸ¥ | æ¯é€±ä¸€   | ä¸Šåˆ 10:00 | `node scripts/render-jobs.js weekly-summary-notifications` |
| `cleanup-notifications`        | æ¸…ç†èˆŠé€šçŸ¥       | æ¯å¤©     | å‡Œæ™¨ 4:00  | `node scripts/render-jobs.js cleanup-notifications`        |

### æ¨è–¦ç³»çµ±ä»»å‹™

| ä»»å‹™åç¨±                      | æè¿°                 | åŸ·è¡Œé »ç‡ | åŸ·è¡Œæ™‚é–“   | å‘½ä»¤                                                      |
| ----------------------------- | -------------------- | -------- | ---------- | --------------------------------------------------------- |
| `update-hot-scores`           | æ›´æ–°ç†±é–€åˆ†æ•¸         | æ¯å°æ™‚   | æ¯å°æ™‚æ•´é» | `node scripts/render-jobs.js update-hot-scores`           |
| `update-content-based`        | æ›´æ–°å…§å®¹åŸºç¤æ¨è–¦     | æ¯å¤©     | å‡Œæ™¨ 5:00  | `node scripts/render-jobs.js update-content-based`        |
| `update-collaborative`        | æ›´æ–°å”åŒéæ¿¾æ¨è–¦     | æ¯å¤©     | å‡Œæ™¨ 6:00  | `node scripts/render-jobs.js update-collaborative`        |
| `update-social-collaborative` | æ›´æ–°ç¤¾äº¤å”åŒéæ¿¾æ¨è–¦ | æ¯å¤©     | å‡Œæ™¨ 7:00  | `node scripts/render-jobs.js update-social-collaborative` |
| `update-all-recommendations`  | æ›´æ–°æ‰€æœ‰æ¨è–¦ç³»çµ±     | æ¯å¤©     | ä¸Šåˆ 8:00  | `node scripts/render-jobs.js update-all-recommendations`  |

### ç¶­è­·ä»»å‹™

| ä»»å‹™åç¨±            | æè¿°               | åŸ·è¡Œé »ç‡ | åŸ·è¡Œæ™‚é–“  | å‘½ä»¤                                            |
| ------------------- | ------------------ | -------- | --------- | ----------------------------------------------- |
| `check-meme-counts` | æª¢æŸ¥ä¸¦ä¿®æ­£è¿·å› è¨ˆæ•¸ | æ¯å¤©     | å‡Œæ™¨ 1:00 | `node scripts/render-jobs.js check-meme-counts` |
| `check-user-counts` | æª¢æŸ¥ä¸¦ä¿®æ­£ç”¨æˆ¶è¨ˆæ•¸ | æ¯å¤©     | å‡Œæ™¨ 1:00 | `node scripts/render-jobs.js check-user-counts` |

## ğŸš€ è¨­ç½®æ­¥é©Ÿ

### æ­¥é©Ÿ 1: æŸ¥çœ‹å®šæœŸä»»å‹™é…ç½®

```bash
# æŸ¥çœ‹æ‰€æœ‰å®šæœŸä»»å‹™é…ç½®
node scripts/schedule-jobs.js show
```

### æ­¥é©Ÿ 2: å‰µå»ºæ‰€æœ‰å®šæœŸä»»å‹™

```bash
# å‰µå»ºæ‰€æœ‰å®šæœŸä»»å‹™ï¼ˆä¸€æ¬¡æ€§å‰µå»ºï¼‰
node scripts/schedule-jobs.js create
```

### æ­¥é©Ÿ 3: åœ¨ Render Dashboard ä¸­è¨­ç½® Cron Jobs

1. **ç™»å…¥ Render Dashboard**
   - è¨ªå• [https://dashboard.render.com](https://dashboard.render.com)

2. **å‰µå»º Cron Job æœå‹™**
   - é»æ“Š "New" â†’ "Cron Job"
   - é¸æ“‡ä½ çš„ä¸»æœå‹™ä½œç‚º base service

3. **è¨­ç½®åŸºæœ¬é…ç½®**
   - **Name**: `å®šæœŸä»»å‹™æœå‹™`
   - **Start Command**: `cd /opt/render/project/src && node scripts/render-jobs.js cleanup-reminders`
   - **Schedule**: `0 2 * * *` (æ¯å¤©å‡Œæ™¨2é»)

4. **è¨­ç½®ç’°å¢ƒè®Šæ•¸**
   - ç¢ºä¿æ‰€æœ‰å¿…è¦çš„ç’°å¢ƒè®Šæ•¸éƒ½å·²è¨­ç½®
   - åƒè€ƒ `docs/render-one-off-jobs.md` ä¸­çš„ç’°å¢ƒè®Šæ•¸è¨­ç½®

### æ­¥é©Ÿ 4: è¨­ç½®å¤šå€‹ Cron Jobs

å°æ–¼ä¸åŒé »ç‡çš„ä»»å‹™ï¼Œä½ éœ€è¦å‰µå»ºå¤šå€‹ Cron Job æœå‹™ï¼š

#### æ¯å°æ™‚åŸ·è¡Œçš„ä»»å‹™

- **Name**: `æ¯å°æ™‚ä»»å‹™`
- **Start Command**: `cd /opt/render/project/src && node scripts/render-jobs.js update-hot-scores`
- **Schedule**: `0 * * * *`

#### æ¯å¤©åŸ·è¡Œçš„ä»»å‹™

- **Name**: `æ¯æ—¥ç¶­è­·ä»»å‹™`
- **Start Command**: `cd /opt/render/project/src && node scripts/render-jobs.js cleanup-reminders`
- **Schedule**: `0 2 * * *`

#### æ¯é€±åŸ·è¡Œçš„ä»»å‹™

- **Name**: `æ¯é€±ä»»å‹™`
- **Start Command**: `cd /opt/render/project/src && node scripts/render-jobs.js weekly-summary-notifications`
- **Schedule**: `0 10 * * 1`

## ğŸ“… Cron è¡¨é”å¼èªªæ˜

| è¡¨é”å¼        | èªªæ˜           | ç¯„ä¾‹         |
| ------------- | -------------- | ------------ |
| `0 2 * * *`   | æ¯å¤©å‡Œæ™¨2é»    | ç”¨æˆ¶æ¸…ç†ä»»å‹™ |
| `0 * * * *`   | æ¯å°æ™‚æ•´é»     | ç†±é–€åˆ†æ•¸æ›´æ–° |
| `0 10 * * 1`  | æ¯é€±ä¸€ä¸Šåˆ10é» | é€±å ±é€šçŸ¥     |
| `0 1-6 * * *` | æ¯å¤©å‡Œæ™¨1-6é»  | ç¶­è­·ä»»å‹™     |

## ğŸ”§ é«˜ç´šé…ç½®

### ä½¿ç”¨ API è‡ªå‹•åŒ–è¨­ç½®

å¦‚æœä½ æƒ³è¦å®Œå…¨è‡ªå‹•åŒ–è¨­ç½®éç¨‹ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘å€‘çš„ API å®¢æˆ¶ç«¯ï¼š

```bash
# å‰µå»ºå–®å€‹ä»»å‹™
node scripts/render-api-client.js create cleanup-reminders

# æ‰¹é‡å‰µå»ºä»»å‹™
node scripts/schedule-jobs.js create
```

### ç›£æ§å’Œè­¦å ±è¨­ç½®

1. **è¨­ç½®å¤±æ•—é€šçŸ¥**
   - åœ¨ Render Dashboard ä¸­è¨­ç½®å¤±æ•—é€šçŸ¥
   - é…ç½® Slack æˆ– Email é€šçŸ¥

2. **ç›£æ§ä»»å‹™åŸ·è¡Œ**
   - å®šæœŸæª¢æŸ¥ä»»å‹™åŸ·è¡Œç‹€æ…‹
   - æŸ¥çœ‹ä»»å‹™æ—¥èªŒå’ŒéŒ¯èª¤ä¿¡æ¯

## ğŸ¯ æœ€ä½³å¯¦è¸

### 1. ä»»å‹™æ™‚é–“å®‰æ’

- **é¿å…é‡ç–Š**ï¼šç¢ºä¿ä»»å‹™ä¸æœƒåŒæ™‚åŸ·è¡Œ
- **åˆç†åˆ†é…**ï¼šå°‡è€—æ™‚ä»»å‹™å®‰æ’åœ¨ä½å³°æœŸ
- **è€ƒæ…®æ™‚å€**ï¼šæ³¨æ„æœå‹™å™¨æ™‚å€è¨­ç½®

### 2. è³‡æºç®¡ç†

- **ç›£æ§è³‡æºä½¿ç”¨**ï¼šæ³¨æ„ CPU å’Œè¨˜æ†¶é«”ä½¿ç”¨
- **é¿å…éè¼‰**ï¼šä¸è¦åŒæ™‚åŸ·è¡Œå¤ªå¤šä»»å‹™
- **å„ªåŒ–åŸ·è¡Œæ™‚é–“**ï¼šå„˜é‡ç¸®çŸ­ä»»å‹™åŸ·è¡Œæ™‚é–“

### 3. éŒ¯èª¤è™•ç†

- **è¨­ç½®é‡è©¦æ©Ÿåˆ¶**ï¼šå°æ–¼é‡è¦ä»»å‹™è¨­ç½®è‡ªå‹•é‡è©¦
- **è¨˜éŒ„éŒ¯èª¤æ—¥èªŒ**ï¼šè©³ç´°è¨˜éŒ„éŒ¯èª¤ä¿¡æ¯
- **è¨­ç½®è­¦å ±**ï¼šå¤±æ•—æ™‚åŠæ™‚é€šçŸ¥

### 4. æ¸¬è©¦å’Œé©—è­‰

- **å…ˆåœ¨æ¸¬è©¦ç’°å¢ƒé©—è­‰**ï¼šç¢ºä¿ä»»å‹™åŠŸèƒ½æ­£å¸¸
- **é€æ­¥éƒ¨ç½²**ï¼šå…ˆéƒ¨ç½²å°‘é‡ä»»å‹™ï¼Œå†é€æ­¥å¢åŠ 
- **ç›£æ§åŸ·è¡Œçµæœ**ï¼šå®šæœŸæª¢æŸ¥ä»»å‹™åŸ·è¡Œæ•ˆæœ

## ğŸ“Š ç›£æ§å’Œç¶­è­·

### æŸ¥çœ‹ä»»å‹™ç‹€æ…‹

```bash
# åˆ—å‡ºæ‰€æœ‰ä»»å‹™
node scripts/render-api-client.js list

# æŸ¥çœ‹ç‰¹å®šä»»å‹™ç‹€æ…‹
node scripts/render-api-client.js status <job-id>
```

### å¸¸è¦‹å•é¡Œæ’æŸ¥

1. **ä»»å‹™åŸ·è¡Œå¤±æ•—**
   - æª¢æŸ¥ç’°å¢ƒè®Šæ•¸è¨­ç½®
   - æŸ¥çœ‹ä»»å‹™æ—¥èªŒ
   - ç¢ºèªæ•¸æ“šåº«é€£æ¥

2. **ä»»å‹™åŸ·è¡Œæ™‚é–“éé•·**
   - å„ªåŒ–ä»»å‹™é‚è¼¯
   - æª¢æŸ¥è³‡æºä½¿ç”¨
   - è€ƒæ…®åˆ†æ‰¹è™•ç†

3. **ä»»å‹™æœªæŒ‰æ™‚åŸ·è¡Œ**
   - æª¢æŸ¥ Cron è¡¨é”å¼
   - ç¢ºèªæ™‚å€è¨­ç½®
   - æŸ¥çœ‹æœå‹™ç‹€æ…‹

## ğŸ“ æ³¨æ„äº‹é …

1. **å‚™ä»½é‡è¦æ•¸æ“š**ï¼šåŸ·è¡Œæ¸…ç†ä»»å‹™å‰å‹™å¿…å‚™ä»½
2. **æ¸¬è©¦ç’°å¢ƒé©—è­‰**ï¼šå…ˆåœ¨æ¸¬è©¦ç’°å¢ƒä¸­é©—è­‰æ‰€æœ‰ä»»å‹™
3. **ç›£æ§åŸ·è¡Œæ•ˆæœ**ï¼šå®šæœŸæª¢æŸ¥ä»»å‹™åŸ·è¡Œçµæœ
4. **æ›´æ–°æ–‡æª”**ï¼šä»»å‹™è®Šæ›´æ™‚åŠæ™‚æ›´æ–°æ–‡æª”

## ğŸ‰ å®Œæˆè¨­ç½®

å®Œæˆä»¥ä¸Šæ­¥é©Ÿå¾Œï¼Œä½ çš„ç³»çµ±å°‡å…·å‚™å®Œæ•´çš„è‡ªå‹•åŒ–ç¶­è­·èƒ½åŠ›ï¼š

- âœ… è‡ªå‹•ç”¨æˆ¶ç®¡ç†ï¼ˆæ¸…ç†å’Œæé†’ï¼‰
- âœ… è‡ªå‹•é€šçŸ¥ç³»çµ±ï¼ˆç†±é–€å…§å®¹å’Œé€±å ±ï¼‰
- âœ… è‡ªå‹•æ¨è–¦ç³»çµ±æ›´æ–°
- âœ… è‡ªå‹•ç¶­è­·å’Œæ•¸æ“šä¸€è‡´æ€§æª¢æŸ¥

é€™æ¨£å¯ä»¥å¤§å¤§æ¸›å°‘æ‰‹å‹•ç¶­è­·å·¥ä½œï¼Œæé«˜ç³»çµ±ç©©å®šæ€§å’Œç”¨æˆ¶é«”é©—ã€‚
